<html data-reactid=".28u9zx8vg8w" data-react-checksum="1622599416"><head data-reactid=".28u9zx8vg8w.0"><meta charset="utf-8" data-reactid=".28u9zx8vg8w.0.0"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" data-reactid=".28u9zx8vg8w.0.1"><title data-reactid=".28u9zx8vg8w.0.2">Jest | A JavaScript Testing Library</title><meta name="viewport" content="width=device-width" data-reactid=".28u9zx8vg8w.0.3"><meta property="og:title" content="Jest | A JavaScript Testing Library" data-reactid=".28u9zx8vg8w.0.4"><meta property="og:type" content="website" data-reactid=".28u9zx8vg8w.0.5"><meta property="og:url" content="http:&#x2f;&#x2f;facebook.github.io&#x2f;jest&#x2f;index.html" data-reactid=".28u9zx8vg8w.0.6"><meta property="og:image" content="http:&#x2f;&#x2f;facebook.github.io&#x2f;react&#x2f;img&#x2f;logo_og.png" data-reactid=".28u9zx8vg8w.0.7"><meta property="og:description" content="A JavaScript Testing Library" data-reactid=".28u9zx8vg8w.0.8"><meta property="fb:app_id" content="623268441017527" data-reactid=".28u9zx8vg8w.0.9"><link rel="shortcut icon" href="http:&#x2f;&#x2f;facebook.github.io&#x2f;react&#x2f;favicon.ico" data-reactid=".28u9zx8vg8w.0.a"><link rel="stylesheet" href="&#x2f;jest&#x2f;css&#x2f;jest.css" data-reactid=".28u9zx8vg8w.0.b"><script type="text&#x2f;javascript" src="&#x2f;&#x2f;use.typekit.net&#x2f;vqa1hcx.js" data-reactid=".28u9zx8vg8w.0.c"></script><script type="text&#x2f;javascript" data-reactid=".28u9zx8vg8w.0.d">try{Typekit.load();}catch(e){}</script></head><body data-reactid=".28u9zx8vg8w.1"><div class="container" data-reactid=".28u9zx8vg8w.1.0"><div class="nav-main" data-reactid=".28u9zx8vg8w.1.0.0"><div class="wrap" data-reactid=".28u9zx8vg8w.1.0.0.0"><a class="nav-home" href="&#x2f;jest&#x2f;index.html" data-reactid=".28u9zx8vg8w.1.0.0.0.0">Jest</a><ul class="nav-site" data-reactid=".28u9zx8vg8w.1.0.0.0.1"><li data-reactid=".28u9zx8vg8w.1.0.0.0.1.$docs"><a href="&#x2f;jest&#x2f;docs&#x2f;tutorial.html" class="active" data-reactid=".28u9zx8vg8w.1.0.0.0.1.$docs.0">docs</a></li><li data-reactid=".28u9zx8vg8w.1.0.0.0.1.$support"><a href="&#x2f;jest&#x2f;support.html" class="" data-reactid=".28u9zx8vg8w.1.0.0.0.1.$support.0">support</a></li><li data-reactid=".28u9zx8vg8w.1.0.0.0.1.$github"><a href="http:&#x2f;&#x2f;github.com&#x2f;facebook&#x2f;jest" class="" data-reactid=".28u9zx8vg8w.1.0.0.0.1.$github.0">github</a></li></ul></div></div><section class="content wrap documentationContent" data-reactid=".28u9zx8vg8w.1.0.1"><div class="nav-docs" data-reactid=".28u9zx8vg8w.1.0.1.0"><div class="nav-docs-section" data-reactid=".28u9zx8vg8w.1.0.1.0.$Quick Start"><h3 data-reactid=".28u9zx8vg8w.1.0.1.0.$Quick Start.0">Quick Start</h3><ul data-reactid=".28u9zx8vg8w.1.0.1.0.$Quick Start.1"><li data-reactid=".28u9zx8vg8w.1.0.1.0.$Quick Start.1.$getting-started"><a style="margin-left:0;" class="" href="&#x2f;jest&#x2f;docs&#x2f;getting-started.html" data-reactid=".28u9zx8vg8w.1.0.1.0.$Quick Start.1.$getting-started.0">Getting Started</a></li><li data-reactid=".28u9zx8vg8w.1.0.1.0.$Quick Start.1.$tutorial"><a style="margin-left:0;" class="" href="&#x2f;jest&#x2f;docs&#x2f;tutorial.html" data-reactid=".28u9zx8vg8w.1.0.1.0.$Quick Start.1.$tutorial.0">Tutorial</a></li></ul></div><div class="nav-docs-section" data-reactid=".28u9zx8vg8w.1.0.1.0.$Deep Dive"><h3 data-reactid=".28u9zx8vg8w.1.0.1.0.$Deep Dive.0">Deep Dive</h3><ul data-reactid=".28u9zx8vg8w.1.0.1.0.$Deep Dive.1"><li data-reactid=".28u9zx8vg8w.1.0.1.0.$Deep Dive.1.$mock-functions"><a style="margin-left:0;" class="" href="&#x2f;jest&#x2f;docs&#x2f;mock-functions.html" data-reactid=".28u9zx8vg8w.1.0.1.0.$Deep Dive.1.$mock-functions.0">Mock functions</a></li><li data-reactid=".28u9zx8vg8w.1.0.1.0.$Deep Dive.1.$automatically-generated-mocks"><a style="margin-left:0;" class="" href="&#x2f;jest&#x2f;docs&#x2f;automatically-generated-mocks.html" data-reactid=".28u9zx8vg8w.1.0.1.0.$Deep Dive.1.$automatically-generated-mocks.0">Automatically generated mocks</a></li><li data-reactid=".28u9zx8vg8w.1.0.1.0.$Deep Dive.1.$manual-mocks"><a style="margin-left:0;" class="" href="&#x2f;jest&#x2f;docs&#x2f;manual-mocks.html" data-reactid=".28u9zx8vg8w.1.0.1.0.$Deep Dive.1.$manual-mocks.0">Manual mocks</a></li><li data-reactid=".28u9zx8vg8w.1.0.1.0.$Deep Dive.1.$timer-mocks"><a style="margin-left:0;" class="" href="&#x2f;jest&#x2f;docs&#x2f;timer-mocks.html" data-reactid=".28u9zx8vg8w.1.0.1.0.$Deep Dive.1.$timer-mocks.0">Timer mocks</a></li><li data-reactid=".28u9zx8vg8w.1.0.1.0.$Deep Dive.1.$dependency-injection"><a style="margin-left:0;" class="" href="&#x2f;jest&#x2f;docs&#x2f;dependency-injection.html" data-reactid=".28u9zx8vg8w.1.0.1.0.$Deep Dive.1.$dependency-injection.0">Dependency Injection</a></li></ul></div><div class="nav-docs-section" data-reactid=".28u9zx8vg8w.1.0.1.0.$Reference"><h3 data-reactid=".28u9zx8vg8w.1.0.1.0.$Reference.0">Reference</h3><ul data-reactid=".28u9zx8vg8w.1.0.1.0.$Reference.1"><li data-reactid=".28u9zx8vg8w.1.0.1.0.$Reference.1.$api"><a style="margin-left:0;" class="" href="&#x2f;jest&#x2f;docs&#x2f;api.html" data-reactid=".28u9zx8vg8w.1.0.1.0.$Reference.1.$api.0">API</a></li></ul></div></div><div class="inner-content" data-reactid=".28u9zx8vg8w.1.0.1.1"><h1 data-reactid=".28u9zx8vg8w.1.0.1.1.0">Asynchronous Testing</h1><div data-reactid=".28u9zx8vg8w.1.0.1.1.1"><hr data-reactid=".28u9zx8vg8w.1.0.1.1.1.0"><p data-reactid=".28u9zx8vg8w.1.0.1.1.1.1"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.1.0">We want to test the following function (borrowed from </span><a href="http:&#x2f;&#x2f;martinfowler.com&#x2f;articles&#x2f;asyncJS.html" data-reactid=".28u9zx8vg8w.1.0.1.1.1.1.1"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.1.1.0">this great article on testing asynchronous functions</span></a><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.1.2">). It does an ajax request to get the current user as JSON, transforms this JSON into a new object and pass it to the callback. Very typical code.</span></p><div class="prism language-javascript" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2"><span class="token comment" spellcheck="true" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$0">&#x2f;&#x2f; fetchCurrentUser.js
</span><span class="token keyword" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$1">var</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.2"> $ </span><span class="token operator" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$3">=</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.4"> </span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$5"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$5.0">require</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$5.$1">(</span></span><span class="token string" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$6">&#x27;jquery&#x27;</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$7">)</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$8">;</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.9">

</span><span class="token keyword" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$10">function</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.b"> </span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$12"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$12.0">parseUserJson</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$12.$1">(</span></span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.d">userJson</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$14">)</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.f"> </span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$16">{</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.h">
  </span><span class="token keyword" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$18">return</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.j"> </span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$20">{</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.l">
    loggedIn</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$22">:</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.n"> </span><span class="token boolean" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$24">true</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$25">,</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.q">
    fullName</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$27">:</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.s"> userJson</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$29">.</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.u">firstName </span><span class="token operator" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$31">+</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.w"> </span><span class="token string" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$33">&#x27; &#x27;</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.y"> </span><span class="token operator" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$35">+</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.10"> userJson</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$37">.</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.12">lastName
  </span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$39">}</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$40">;</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.15">
</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$42">}</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$43">;</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.18">

</span><span class="token keyword" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$45">function</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.1a"> </span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$47"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$47.0">fetchCurrentUser</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$47.$1">(</span></span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.1c">callback</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$49">)</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.1e"> </span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$51">{</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.1g">
  </span><span class="token keyword" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$53">function</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.1i"> </span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$55"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$55.0">ajaxDone</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$55.$1">(</span></span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.1k">userJson</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$57">)</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.1m"> </span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$59">{</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.1o">
    </span><span class="token keyword" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$61">var</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.1q"> user </span><span class="token operator" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$63">=</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.1s"> </span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$65"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$65.0">parseUserJson</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$65.$1">(</span></span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.1u">userJson</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$67">)</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$68">;</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.1x">
    </span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$70"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$70.0">callback</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$70.$1">(</span></span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.1z">user</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$72">)</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$73">;</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.22">
  </span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$75">}</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$76">;</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.25">

  </span><span class="token keyword" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$78">return</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.27"> $</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$80">.</span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$81"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$81.0">ajax</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$81.$1">(</span></span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$82">{</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.2b">
    type</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$84">:</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.2d"> </span><span class="token string" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$86">&#x27;GET&#x27;</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$87">,</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.2g">
    url</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$89">:</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.2i"> </span><span class="token string" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$91">&#x27;http:&#x2f;&#x2f;example.com&#x2f;currentUser&#x27;</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$92">,</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.2l">
    done</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$94">:</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.2n"> ajaxDone
  </span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$96">}</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$97">)</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$98">;</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.2r">
</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$100">}</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$101">;</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.2u">

module</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$103">.</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.2w">exports </span><span class="token operator" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$105">=</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.2y"> fetchCurrentUser</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.2.$107">;</span></div><h2 data-reactid=".28u9zx8vg8w.1.0.1.1.1.3"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.3.0">Writing the test</span></h2><p data-reactid=".28u9zx8vg8w.1.0.1.1.1.4"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.4.0">In order to test the function we first need to write a new file along with some boilerplate</span></p><div class="prism language-javascript" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5"><span class="token comment" spellcheck="true" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$0">&#x2f;&#x2f; __tests__&#x2f;fetchCurrentUser-test.js
</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.1">jest</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$2">.</span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$3"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$3.0">dontMock</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$3.$1">(</span></span><span class="token string" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$4">&#x27;..&#x2f;fetchCurrentUser.js&#x27;</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$5">)</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$6">;</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.7">

</span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$8"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$8.0">describe</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$8.$1">(</span></span><span class="token string" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$9">&#x27;fetchCurrentUser&#x27;</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$10">,</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.b"> </span><span class="token keyword" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$12">function</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$13">(</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$14">)</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.f"> </span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$16">{</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.h">
  </span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$18"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$18.0">it</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$18.$1">(</span></span><span class="token string" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$19">&#x27;creates a parsed user&#x27;</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$20">,</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.l"> </span><span class="token keyword" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$22">function</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$23">(</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$24">)</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.p"> </span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$26">{</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.r">
    </span><span class="token keyword" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$28">var</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.t"> $ </span><span class="token operator" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$30">=</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.v"> </span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$32"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$32.0">require</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$32.$1">(</span></span><span class="token string" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$33">&#x27;jquery&#x27;</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$34">)</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$35">;</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.10">
    </span><span class="token keyword" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$37">var</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.12"> fetchCurrentUser </span><span class="token operator" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$39">=</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.14"> </span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$41"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$41.0">require</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$41.$1">(</span></span><span class="token string" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$42">&#x27;..&#x2f;fetchCurrentUser.js&#x27;</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$43">)</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$44">;</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.19">

   </span><span class="token comment" spellcheck="true" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$46"> &#x2f;&#x2f; ... missing code ...
</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.1b">  </span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$48">}</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$49">)</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$50">;</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.1f">
</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$52">}</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$53">)</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.5.$54">;</span></div><p data-reactid=".28u9zx8vg8w.1.0.1.1.1.6"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.6.0">We want to make sure that the callback given to </span><code data-reactid=".28u9zx8vg8w.1.0.1.1.1.6.1">fetchCurrentUser</code><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.6.2"> is correctly executed. In order to do that, we&#x27;re going to generate a mock function and make sure that it is called with the proper arguments.</span></p><div class="prism language-javascript" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.0">    </span><span class="token keyword" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$1">var</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.2"> fetchCallback </span><span class="token operator" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$3">=</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.4"> </span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$5"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$5.0">require</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$5.$1">(</span></span><span class="token string" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$6">&#x27;mocks&#x27;</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$7">)</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$8">.</span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$9"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$9.0">getMockFunction</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$9.$1">(</span></span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$10">)</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$11">;</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.c">
    </span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$13"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$13.0">fetchCurrentUser</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$13.$1">(</span></span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.e">fetchCallback</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$15">)</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$16">;</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.h">

   </span><span class="token comment" spellcheck="true" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$18"> &#x2f;&#x2f; ... missing code ...
</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.j">
    </span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$20"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$20.0">expect</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$20.$1">(</span></span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.l">fetchCallback</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$22">)</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$23">.</span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$24"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$24.0">toBeCalledWith</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$24.$1">(</span></span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$25">{</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.q">
      loggedIn</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$27">:</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.s"> </span><span class="token boolean" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$29">true</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$30">,</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.v">
      fullName</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$32">:</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.x"> </span><span class="token string" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$34">&#x27;Tomas Jakobsen&#x27;</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.z">
    </span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$36">}</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$37">)</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.7.$38">;</span></div><p data-reactid=".28u9zx8vg8w.1.0.1.1.1.8"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.8.0">In order to compute the result, </span><code data-reactid=".28u9zx8vg8w.1.0.1.1.1.8.1">fetchCurrentUser</code><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.8.2"> is calling to a dependency: </span><code data-reactid=".28u9zx8vg8w.1.0.1.1.1.8.3">$.ajax</code><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.8.4">. To write a proper test, we first need to make sure that it is calling the dependency correctly.</span></p><div class="prism language-javascript" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.0">    </span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$1"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$1.0">expect</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$1.$1">(</span></span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.2">$</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$3">.</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.4">ajax</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$5">)</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$6">.</span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$7"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$7.0">toBeCalledWith</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$7.$1">(</span></span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$8">{</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.9">
      type</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$10">:</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.b"> </span><span class="token string" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$12">&#x27;GET&#x27;</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$13">,</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.e">
      url</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$15">:</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.g"> </span><span class="token string" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$17">&#x27;http:&#x2f;&#x2f;example.com&#x2f;currentUser&#x27;</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$18">,</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.j">
      done</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$20">:</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.l"> jasmine</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$22">.</span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$23"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$23.0">any</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$23.$1">(</span></span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.o">Function</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$25">)</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.q">
    </span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$27">}</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$28">)</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.9.$29">;</span></div><p data-reactid=".28u9zx8vg8w.1.0.1.1.1.a"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.a.0">and then provide a mock response for the dependency</span></p><div class="prism language-javascript" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.0">    $</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$1">.</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.2">ajax</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$3">.</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.4">mock</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$5">.</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.6">calls</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$7">[</span><span class="token number" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$8">0</span><span class="token comment" spellcheck="true" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$9">&#x2f;*first call*&#x2f;</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$10">]</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$11">[</span><span class="token number" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$12">0</span><span class="token comment" spellcheck="true" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$13">&#x2f;*first argument*&#x2f;</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$14">]</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$15">.</span><span class="token function" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$16"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$16.0">done</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$16.$1">(</span></span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$17">{</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.i">
      firstName</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$19">:</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.k"> </span><span class="token string" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$21">&#x27;Tomas&#x27;</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$22">,</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.n">
      lastName</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$24">:</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.p"> </span><span class="token string" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$26">&#x27;Jakobsen&#x27;</span><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.r">
    </span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$28">}</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$29">)</span><span class="token punctuation" data-reactid=".28u9zx8vg8w.1.0.1.1.1.b.$30">;</span></div><p data-reactid=".28u9zx8vg8w.1.0.1.1.1.c"><span data-reactid=".28u9zx8vg8w.1.0.1.1.1.c.0">Unlike most testing libraries, jest doesn&#x27;t use a different mode for testing asynchronous functions versus synchronous ones. It gets away with it by mocking everything by default and providing a powerful mock function abstraction.</span></p></div><div class="docs-prevnext" data-reactid=".28u9zx8vg8w.1.0.1.1.2"><a class="docs-prev" href="tutorial.html" data-reactid=".28u9zx8vg8w.1.0.1.1.2.0">← Prev</a><a class="docs-next" href="mock-functions.html" data-reactid=".28u9zx8vg8w.1.0.1.1.2.1">Next →</a></div></div></section><footer class="wrap" data-reactid=".28u9zx8vg8w.1.0.2"><div class="right" data-reactid=".28u9zx8vg8w.1.0.2.0">© 2014 Facebook Inc.</div></footer></div><div id="fb-root" data-reactid=".28u9zx8vg8w.1.1"></div><script data-reactid=".28u9zx8vg8w.1.2">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-41298772-1', 'facebook.github.io');
            ga('send', 'pageview');

            !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)
            ){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";
            fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
          </script><script type="text/javascript" src="/jest/docs/asynchronous-testing.includeRequire.bundle"> </script><packaged ></packaged><script type="text/javascript">require('es5-shim/es5-shim.js');require('es5-shim/es5-sham.js');var React = require('React');var ReactMount = require('ReactMount');var Component = require('website/src/jest/docs/asynchronous-testing.js');ReactMount.allowFullPageRender = true;React.renderComponent(Component({"requestParams":{}}),document);</script></body></html>